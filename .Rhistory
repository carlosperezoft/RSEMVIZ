par(mar=c(7,3,1,1))  # Increase bottom margin to have the complete label
plot(dend)
install.packages("dendextend")
iris[c(1,2)] %>% dist() %>% hclust() %>% as.dendrogram() -> dend
library("dendextend", lib.loc="C:/PEREZOFT_DLLO/R_STAT_343/library")
library("dendextend", lib.loc="C:/PEREZOFT_DLLO/R_STAT_343/library")
iris[c(1,2)] %>% dist() %>% hclust() %>% as.dendrogram() -> dend
par(mar=c(7,3,1,1))  # Increase bottom margin to have the complete label
plot(dend)
# Left:
dend %>%
# Custom branches
set("branches_col", "grey") %>% set("branches_lwd", 3) %>%
# Custom labels
set("labels_col", "orange") %>% set("labels_cex", 0.8) %>%
plot()
# About nodes: you can choose to display all nodes, or just leaf nodes:
dend %>% set("nodes_pch", 19)  %>% set("nodes_cex", 0.7) %>% set("nodes_col", "orange") %>% plot()
dend %>% set("leaves_pch", 19)  %>% set("leaves_cex", 0.7) %>% set("leaves_col", "skyblue") %>% plot()
par(mar=c(1,1,1,7))
dend %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3) %>%
plot(horiz=TRUE, axes=FALSE)
abline(v = 350, lty = 2)
# Highlight a cluster with rectangle
par(mar=c(9,1,1,1))
dend %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3) %>%
plot(axes=FALSE)
dend %>% rect.dendrogram(k=3, lty = 5, lwd = 0, x=1, col=rgb(0.1, 0.2, 0.4, 0.1)) %>% plot()
d1 = iris[c(1,2)] %>% dist() %>% hclust( method="average" ) %>% as.dendrogram()
d2 = iris[c(3,4)] %>% dist() %>% hclust( method="complete" ) %>% as.dendrogram()
# Custom these kendo, and place them in a list
dl <- dendlist(
d1 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3),
d2 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3)
)
tanglegram(dl,
common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE,
margin_inner=7,
lwd=2
)
d1 = iris[c(1,2)] %>% dist() %>% hclust( method="average" ) %>% as.dendrogram()
d2 = iris[c(3,4)] %>% dist() %>% hclust( method="average" ) %>% as.dendrogram()
dl <- dendlist(
d1 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3),
d2 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3)
)
tanglegram(dl,
common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE,
margin_inner=7,
lwd=2
)
d1 = iris[c(1)] %>% dist() %>% hclust( method="average" ) %>% as.dendrogram()
d2 = iris[c(2)] %>% dist() %>% hclust( method="average" ) %>% as.dendrogram()
# Custom these kendo, and place them in a list
dl <- dendlist(
d1 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3),
d2 %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_lty", 1) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3)
)
tanglegram(dl,
common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE,
margin_inner=7,
lwd=2
)
par(mar=c(1,1,1,7))
dend %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3) %>%
plot(horiz=TRUE, axes=FALSE)
abline(v = 350, lty = 2)
par(mar=c(1,1,1,7))
dend %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3) %>%
plot(horiz=TRUE, axes=T)
abline(v = 350, lty = 2)
par(mar=c(1,1,1,7))
dend %>%
set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3) %>%
plot(horiz=F, axes=T)
abline(v = 350, lty = 2)
dend <- click_rotate(dend)
dend <- click_rotate(dend, continue = TRUE)
shiny::runApp('inst/appweb')
dend <- iris[1:30,-5] %>% dist %>% hclust %>% as.dendrogram %>%
set("branches_k_color", k=3) %>% set("branches_lwd", c(1.5,1,1.5)) %>%
set("branches_lty", c(1,1,3,1,1,2)) %>%
set("labels_colors") %>% set("labels_cex", c(.9,1.2))
plot(dend)
ggd1 <- as.ggdend(dend)
library(ggplot2)
ggplot(ggd1) # reproducing
labels(dend) <- paste0(labels(dend), "00000")
ggd1 <- as.ggdend(dend)
# Use ylim to deal with long labels in ggplot2
ggplot(ggd1) + ylim(-.4, max(get_branches_heights(dend)) )
ggplot(ggd1, horiz = TRUE) # horiz plot in ggplot2
#
ggplot(ggd1) + scale_y_reverse(expand = c(0.2, 0)) + coord_polar(theta="x")
#
ggplot(ggd1, labels = FALSE) + scale_y_reverse(expand = c(0.2, 0)) + coord_polar(theta="x")
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
iris[3, "Species"]
runApp('inst/appweb')
runApp('inst/appweb')
LETTERS[1:3][3]
runApp('inst/appweb')
sample(LETTERS[1:3], 1)
sample(LETTERS[1:3], 1)
sample(LETTERS[1:3], 1)
sample(LETTERS[1:3], 1)
sample(LETTERS[1:3], 1)
sample(LETTERS[1:3], 1)
LETTERS[1:3][3]
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
rows_picking <- c(1:5, 25:30)
dend <- (iris[rows_picking,-5]*10) %>% dist %>% hclust %>% as.dendrogram
odd_numbers <- rows_picking %% 2
cols <- c("gold", "grey")[odd_numbers+1]
plot(dend)
colored_bars(cols, dend)
k2 <- cutree(dend, k = 2)
cols2 <- c("#0082CE", "#CC476B")[k2]
plot(dend)
k2 <- cutree(dend, k = 2)
cols2 <- c("#0082CE", "#CC476B")[k2]
plot(dend)
colored_bars(cbind(cols2, cols), dend,
rowLabels = c("2 clusters", "Odd numbers"))
cols2
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
library("dendextend", lib.loc="C:/PEREZOFT_DLLO/R_STAT_343/library")
rows_picking <- c(1:5, 25:30)
dend <- (iris[rows_picking,-5]*10) %>% dist %>% hclust %>% as.dendrogram
odd_numbers <- rows_picking %% 2
cols <- c("red", "white")[odd_numbers+1]
plot(dend)
colored_dots(cols, dend)
plot(dend)
colored_dots(cols, dend, y_shift = -1,
rowLabels = "Odd\n numbers")
shiny::runApp('inst/appweb')
install.packages("ggdendro")
dend <- USArrests[1:10,] %>% dist %>% hclust %>% as.dendrogram
par(mfrow =c(1,2), mar = rep(6,4))
plot_horiz.dendrogram(dend, side=FALSE)
plot(dend)
plot_horiz.dendrogram(dend, side=TRUE)
plot_horiz.dendrogram(dend, side=TRUE, dLeaf=0, xlim = c(100,-10)) # bad
plot_horiz.dendrogram(dend, side=TRUE, text_offset = 0)
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
par(mfrow = c(1,3))
dend %>% plot(main = "Original")
dend %>% ladderize(TRUE) %>% plot(main = "Right (default)")
dend %>% ladderize(FALSE) %>% plot(main = "Left (rev of right)")
runApp('inst/appweb')
runApp('inst/appweb')
set.seed(23235)
ss <- sample(1:150, 10 )
dend1 <- iris[ss,-5] %>% dist %>% hclust("com") %>% as.dendrogram
dend2 <- iris[ss,-5] %>% dist %>% hclust("sin") %>% as.dendrogram
dend12 <- dendlist(dend1, dend2)
dend12 %>% tanglegram
untangle(dend1, dend2, method="random", R = 5) %>% tanglegram
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
install.packages("ape")
cl
plot(as.phylo(lc), type = "unrooted", cex = 0.6,
no.margin = TRUE)
library("ape", lib.loc="C:/PEREZOFT_DLLO/R_STAT_343/library")
plot(as.phylo(lc), type = "unrooted", cex = 0.6,
no.margin = TRUE)
plot(as.phylo(cl), type = "unrooted", cex = 0.6,
no.margin = TRUE)
plot(as.phylo(cl), type = "unrooted", cex = 0.6,
no.margin = F)
plot(as.phylo(cl), type = "unrooted", cex = 1.6,
no.margin = T)
plot(as.phylo(cl), type = "unrooted", cex = .2,
no.margin = T)
detach("package:ape", unload=TRUE)
runApp('inst/appweb')
runApp('inst/appweb')
dend <- iris[1:40,-5] %>% dist %>% hclust %>% as.dendrogram %>%
set("branches_k_color", k=3) %>% set("branches_lwd", c(5,2,1.5)) %>%
set("branches_lty", c(1,1,3,1,1,2)) %>%
set("labels_colors") %>% set("labels_cex", c(.9,1.2)) %>%
set("nodes_pch", 19) %>% set("nodes_col", c("orange", "black", "plum", NA))
circlize_dendrogram(dend)
circlize_dendrogram(dend, facing = "inside", labels = FALSE)
circlize_dendrogram(dend, facing = "inside", labels = T)
circos.initialize("foo", xlim = c(0, 40))
circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
circos.rect(1:40-0.8, rep(0, 40), 1:40-0.2, runif(40), col = rand_color(40), border = NA)
}, bg.border = NA)
circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
circos.text(1:40-0.5, rep(0, 40), labels(dend), col = labels_colors(dend),
facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
}, bg.border = NA, track.height = 0.1)
max_height = attr(dend, "height")
circos.track(ylim = c(0, max_height), panel.fun = function(x, y) {
circos.dendrogram(dend, max_height = max_height)
}, track.height = 0.5, bg.border = NA)
circos.clear()
circlize_dendrogram(dend)
runApp('inst/appweb')
install.packages("Rcpp")
install.packages("circlepackeR")
devtools::install_github("jeromefroe/circlepackeR")
devtools::install_github("jeromefroe/circlepackeR")
install.packages("yaml")
install.packages("yaml")
devtools::install_github("jeromefroe/circlepackeR")
devtools::install_github("jeromefroe/circlepackeR")
install.packages("ggplot2")
devtools::install_github("jeromefroe/circlepackeR")
shiny::runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
data("flare")
head(flare)
runApp('inst/appweb')
runApp('inst/appweb')
data(acme)
head(acme)
head(acme)
acme
x <- ToDataFrameNetwork(acme, "p", "cost", direction = "climb")
x
xN <- FromDataFrameNetwork(x)
print(xN, "p", "cost")
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
# library
library(circlize)
# Arrange the layout
layout(matrix(1:9, 3, 3))
# A loop to create 9 circular plots
for(i in 1:9) {
par(mar = c(0.5, 0.5, 0.5, 0.5), bg=rgb(1,1,1,0.1) )
factors = 1:8
circos.par(cell.padding = c(0, 0, 0, 0))
circos.initialize(factors, xlim = c(0, 1))
circos.trackPlotRegion(ylim = c(0, 1), track.height = 0.05, bg.col = rand_color(8), bg.border = NA )
# add links
for(i in 1:20) {
se = sample(1:8, 2)
circos.link(se[1], runif(2), se[2], runif(2), col = rand_color(1, transparency = 0.4))
}
circos.clear()
}
# library
library(circlize)
# Arrange the layout
layout(matrix(1:9, 3, 3))
# A loop to create 9 circular plots
for(i in 1:9) {
par(mar = c(0.5, 0.5, 0.5, 0.5), bg=rgb(1,1,1,0.1) )
factors = 1:8
circos.par(cell.padding = c(0, 0, 0, 0))
circos.initialize(factors, xlim = c(0, 1))
circos.trackPlotRegion(ylim = c(0, 1), track.height = 0.05, bg.col = rand_color(8), bg.border = NA )
# add links
for(i in 1:20) {
se = sample(1:8, 2)
circos.link(se[1], runif(2), se[2], runif(2), col = rand_color(1, transparency = 0.4))
}
circos.clear()
}
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
dat1 <- iris[c(1,2)]
dat2 <- iris[c(3,4)]
head(dat1)
head(dat2)
paste(colnames(dat2), "OBS", "_")
paste(colnames(dat2), "OBS", sep="_")
obs_names <- paste(colnames(dat2), "OBS", sep="_")
colnames(dat1) <- obs_names
head(dat1)
scr_names <- paste(colnames(dat2), "SCR", sep="_")
dat1 <- iris[c(1,2)]
dat2 <- iris[c(3,4)]
scr_names <- paste(colnames(dat2), "SCR", sep="_")
obs_names <- paste(colnames(dat1), "OBS", sep="_")
colnames(dat1) <- obs_names
colnames(dat2) <- scr_names
head(dat1)
head(dat2)
all_data <- cbind(dat1, dat2)
head(all_data)
class(all_data)
union_data <- data.frame(dat1, dat2)
class(all_data)
head(union_data)
concat_data <- cbind(dat1, dat2)
runApp('inst/appweb')
shiny::runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
head(iris)
sort_iris <- dplyr::arrange(iris, Sepal.Length)
head(sort_iris)
sort_iris <- dplyr::arrange_all(iris)
head(sort_iris)
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
runApp('inst/appweb')
library(dygraphs)
data(ldeaths)
data("ldeaths")
head(ldeaths)
ldeaths
mdeaths
fdeaths
trend
class(ldeaths)
